integrations:
  cadvisor:
    enabled: true
    docker_only: true
    instance: localhost:9090
    relabel_configs:
      - action: replace
        replacement: integrations/docker
        target_label: job
  node_exporter:
    enabled: true
    relabel_configs:
    - replacement: aptos
      source_labels:
      - __address__
      target_label: instance
  prometheus_remote_write:
  - basic_auth:
      password: eyJrIjoiN2Y5NTRhNzE5OGFjOWIyMDNiOGViOTBkOTM2NmMwN2M3NDNmYjMzNCIsIm4iOiJzdGFjay0zOTUxNjctZWFzeXN0YXJ0LXByb20tcHVibGlzaGVyIiwiaWQiOjY3NDY2MH0=
      username: 490976
    url: https://prometheus-prod-01-eu-west-0.grafana.net/api/prom/push
logs:
  configs:
  - clients:
    - basic_auth:
        password: eyJrIjoiN2Y5NTRhNzE5OGFjOWIyMDNiOGViOTBkOTM2NmMwN2M3NDNmYjMzNCIsIm4iOiJzdGFjay0zOTUxNjctZWFzeXN0YXJ0LXByb20tcHVibGlzaGVyIiwiaWQiOjY3NDY2MH0=
        username: 244458
      url: https://logs-prod-eu-west-0.grafana.net/loki/api/v1/push
      external_labels:
        instance: aptos
    name: integrations
    positions:
      filename: /tmp/positions.yaml
    scrape_configs:
    - job_name: integrations/docker
      docker_sd_configs:
        - host: unix:///var/run/docker.sock
          refresh_interval: 5s
      relabel_configs:
        - action: replace    
          replacement: integrations/docker
          source_labels: 
            - __meta_docker_container_id
          target_label: job 
        - source_labels: 
            - __meta_docker_container_name
          regex: '/(.*)'
          target_label: container
        - source_labels: 
            - __meta_docker_container_log_stream
          target_label: stream
    - job_name: integrations/node_exporter_journal_scrape
      journal:
        labels:
          instance: aptos
          job: integrations/node_exporter
        max_age: 24h
      relabel_configs:
      - source_labels:
        - __journal__systemd_unit
        target_label: unit
      - source_labels:
        - __journal__boot_id
        target_label: boot_id
      - source_labels:
        - __journal__transport
        target_label: transport
      - source_labels:
        - __journal_priority_keyword
        target_label: level
    target_config:
      sync_period: 10s
metrics:
  configs:
  - name: integrations
    remote_write:
    - basic_auth:
        password: eyJrIjoiN2Y5NTRhNzE5OGFjOWIyMDNiOGViOTBkOTM2NmMwN2M3NDNmYjMzNCIsIm4iOiJzdGFjay0zOTUxNjctZWFzeXN0YXJ0LXByb20tcHVibGlzaGVyIiwiaWQiOjY3NDY2MH0=
        username: 490976
      url: https://prometheus-prod-01-eu-west-0.grafana.net/api/prom/push
  global:
    scrape_interval: 60s
  wal_directory: /tmp/grafana-agent-wal
server:
  http_listen_port: 12345